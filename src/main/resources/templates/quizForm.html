<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Create Quiz</title>

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script>
    
 
        $(document).ready(function () {
        	   var questionCounter = 0;

            // When the document is ready, execute the following code
            $("#cloneButton").click(function () {
            	
                // When the button with id "cloneButton" is clicked, execute the following code
                var originalDiv = $("#questionContainer");
          
                // .clone() clones the contents of #cloneContainer instead of the container itself.
                var clonedDiv = $("#cloneContainer").clone();
                
                //Upate name and Id fields for each clone div
                
                var newId = "container" + (questionCounter +1) ;
                clonedDiv.attr("id", newId);
                
                var newClass = "questionList";
                clonedDiv.attr("class", newClass);
                
                
               var newLabel = "Question: " + (questionCounter + 1);
               clonedDiv.find("label").text(newLabel);
               
                clonedDiv.find('input[type="text"]').val('');
               
                //Setting the name for each clone
                // The server uses the names to map the values to corresponding fields in the data model.
                //the value entered in that text field will be associated with the prompt field in the quizQuestion list when the form is submitted.
				
                clonedDiv.find('input').prop('name', `quizQuestion[${questionCounter}].prompt`);
                clonedDiv.show();
                originalDiv.append(clonedDiv);
                questionCounter++;
               
            });
            
                    
      function renumberQuestions() {
   		 $(".questionList").each(function (index) {
        var newId = "container" + (index);
        $(this).attr("id", newId);

        var newLabel = "Question: " + (index +1);
        $(this).find("label").text(newLabel);

        $(this).find('input').prop('name', `quizQuestion[${index}].prompt`);
        questionCounter = $(".questionList").length;
     
    });
}
                   
                   
      $(document).ready(function () {
    // Attach click event to the document and filter for elements with class 'deleteButton' inside '.cloneContainer'
    $(document).on("click", ".deleteButton", function () {
        // Find the closest '.cloneContainer' and remove it
        $(this).closest('.questionList').remove();   
         renumberQuestions();

                });
            });

        
        });
        
        
    </script>
</head>

<body>
<form th:action="@{/api/v1/quiz/registerQuiz}" method="post" th:object = ${quiz}>

	 <div>
        <label> Title </label> <input type="text" th:field="*{quizTitle}" />
	</div>
	
	<!--  
		<div id="container" class = "questionList">
			<label> Question: 1 </label> <input type="text"
				name="quizQuestion[0].prompt" />
		<button type="button" class="deleteButton">Delete Question</button>
		</div>
-->		
		
		<div id="cloneContainer" style="display: none;" class="cloneClass">
  	   <label> Question: </label> <input type="text" name="clone" />
    	 <button type="button" class="deleteButton">Delete Question</button>
		</div>

		<div id="questionContainer"></div>
		
		
				<!--  Maybe code the delete button for question first? -->
			<!--  
			<div id ="choiceContainer">
				<label> Choice: 1 </label> <input type="text"
					name="quizQuestion[0].questionChoice[0].choicePrompt" />
			</div>
		
-->

    <div>
    

        <button type="button" id="cloneButton">Add Question</button>
    <!--      <button type="button" id="deleteButton">Delete Question</button>-->
    </div>
    <div>
        <input type="submit" value="Submit">
    </div>
</form>
</body>
</html>